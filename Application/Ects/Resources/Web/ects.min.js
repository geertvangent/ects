!function(){var i=angular.module("chamilo",[]);i.service("chamiloUtilities",["$http",function(i){this.callChamiloAjax=function(t,e,n,r,a){var s="http://desiderius.ehb.be/index.php?application={{ application }}&go={{ action }}";s=s.replace("{{ application }}",t),s=s.replace("{{ action }}",e),void 0==a&&(a=function(){}),i.post(s,$.param(n),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).success(r).error(a)},this.callChamiloAjaxPromise=function(t,e,n){var r="http://desiderius.ehb.be/index.php?application={{ application }}&go={{ action }}";return r=r.replace("{{ application }}",t),r=r.replace("{{ action }}",e),i.post(r,$.param(n),{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}})}}]);var t=angular.module("trainingBrowserApp",["ngRoute","chamilo"]);t.config(function(i){i.when("/",{templateUrl:"trainingSelectorPanel.html"}).when("/training/:trainingId",{templateUrl:"trainingDetailsPanel.html"}).when("/trajectory/:subTrajectoryId",{templateUrl:"subTrajectoryDetailsPanel.html"}).when("/course/:courseId",{templateUrl:"courseDetailsPanel.html"})}),t.run(function(){}),t.controller("MainController",["$scope","$location",function(i,t){this.goToPath=function(i){t.path(i)}}]),t.controller("TrainingCardsController",["trainingsService","$scope",function(i,t){this.trainingsByType=i.trainingsByType,this.isLoadingTrainingList=i.isLoadingTrainingList,t.$watchCollection(function(){return i.trainingsByType},angular.bind(this,function(i){this.trainingsByType=i})),t.$watch(function(){return i.isLoadingTrainingList},angular.bind(this,function(i){this.isLoadingTrainingList=i}))}]),t.controller("TrainingSelectorController",["trainingsService","$scope",function(i,t){this.academicYears=i.academicYears,this.faculties=i.faculties,this.trainingTypes=i.trainingTypes,this.filterAcademicYear=i.filterAcademicYear,this.filterFaculty=i.filterFaculty,this.filterTrainingType=i.filterTrainingType,this.filterText=i.filterText,t.$watch(function(){return i.academicYears},angular.bind(this,function(i){this.academicYears=i})),t.$watchCollection(function(){return i.faculties},angular.bind(this,function(i){this.faculties=i})),t.$watchCollection(function(){return i.trainingTypes},angular.bind(this,function(i){this.trainingTypes=i})),t.$watch(function(){return i.filterAcademicYear},angular.bind(this,function(i){this.filterAcademicYear=i})),t.$watchCollection(function(){return i.filterFaculty},angular.bind(this,function(i){this.filterFaculty=i})),t.$watchCollection(function(){return i.filterTrainingType},angular.bind(this,function(i){this.filterTrainingType=i})),t.$watchCollection(function(){return i.filterText},angular.bind(this,function(i){this.filterText=i})),this.selectAcademicYear=function(){i.changeAcademicYear(this.filterAcademicYear)},this.selectFaculty=function(){i.changeFaculty(this.filterFaculty)},this.selectTrainingType=function(){i.changeTrainingType(this.filterTrainingType)},this.setFilterText=function(){i.changeFilterText(this.filterText)},this.resetFilters=function(){i.setFaculty(""),i.setFilterText(""),i.retrieveTrainings()},i.retrieveAcademicYears()}]),t.controller("TrainingDetailsController",["trainingsService","$scope","$route","$routeParams",function(i,t,e,n){this.training=i.training,this.isLoadingTraining=i.isLoadingTraining,n.trainingId&&i.retrieveTrainingById(n.trainingId),t.$watchCollection(function(){return i.training},angular.bind(this,function(i){this.training=i})),t.$watch(function(){return i.isLoadingTraining},angular.bind(this,function(i){this.isLoadingTraining=i}))}]),t.controller("SubTrajectoryDetailsController",["coursesService","$scope","$route","$routeParams",function(i,t,e,n){this.subTrajectory=i.subTrajectory,this.isLoadingSubTrajectory=i.isLoadingSubTrajectory,n.subTrajectoryId&&i.retrieveSubTrajectoryById(n.subTrajectoryId),t.$watchCollection(function(){return i.subTrajectory},angular.bind(this,function(i){this.subTrajectory=i})),t.$watch(function(){return i.isLoadingSubTrajectory},angular.bind(this,function(i){this.isLoadingSubTrajectory=i}))}]),t.controller("CourseDetailsController",["chamiloUtilities","coursesService","$scope","$http","$route","$routeParams","$sce",function(i,t,e,n,r,a,s){this.courseId=a.courseId,this.course=t.course,this.courseDetails=t.courseDetails,this.isLoadingCourse=t.isLoadingCourse,this.isLoadingCourseDetails=t.isLoadingCourseDetails,this.courseId&&t.retrieveCourseById(this.courseId),e.$watchCollection(function(){return t.course},angular.bind(this,function(i){this.course=i})),e.$watchCollection(function(){return t.courseDetails},angular.bind(this,function(i){this.courseDetails=i})),e.$watch(function(){return t.isLoadingCourse},angular.bind(this,function(i){this.isLoadingCourse=i})),e.$watch(function(){return t.isLoadingCourseDetails},angular.bind(this,function(i){this.isLoadingCourseDetails=i})),this.getCourseUrl=function(){return s.trustAsResourceUrl("https://bamaflexweb.ehb.be/BMFUIDetailxOLOD.aspx?a="+this.courseId+"&b=5&c=1")},this.getCourseDetails=function(){return this.courseDetails?s.trustAsHtml(this.courseDetails.content):""}}]),t.directive("trainingCardsPanel",function(){return{restrict:"AE",controller:"TrainingCardsController",controllerAs:"trainingCards"}}),t.directive("trainingSelectorPanel",function(){return{restrict:"AE",controller:"TrainingSelectorController",controllerAs:"trainingSelector"}}),t.directive("trainingDetailsPanel",function(){return{restrict:"AE",controller:"TrainingDetailsController",controllerAs:"trainingDetails"}}),t.directive("subTrajectoryDetailsPanel",function(){return{restrict:"AE",controller:"SubTrajectoryDetailsController",controllerAs:"subTrajectoryDetails"}}),t.directive("courseDetailsPanel",function(){return{restrict:"AE",controller:"CourseDetailsController",controllerAs:"courseDetails"}}),t.service("trainingsService",["chamiloUtilities",function(i){this.filterAcademicYear=null,this.filterFaculty=null,this.filterTrainingType=null,this.filterText=null,this.academicYears=[],this.faculties=[],this.trainingTypes=[],this.trainingsByType=[],this.training=null,this.isLoadingTrainingList=!1,this.isLoadingTraining=!1,this.retrieveAcademicYears=function(){i.callChamiloAjax("Ehb\\Application\\Ects\\Ajax","FilterYears",{},angular.bind(this,function(i,t,e,n){this.academicYears=i.properties.year,this.changeAcademicYear(this.academicYears[0])}))},this.retrieveFaculties=function(){i.callChamiloAjax("Ehb\\Application\\Ects\\Ajax","FilterFaculties",{year:null==this.filterAcademicYear?null:this.filterAcademicYear},angular.bind(this,function(i,t,e,n){this.faculties=i.properties.faculty}))},this.retrieveTrainingTypes=function(){i.callChamiloAjax("Ehb\\Application\\Ects\\Ajax","FilterTrainingTypes",{year:null==this.filterAcademicYear?null:this.filterAcademicYear,faculty:null==this.filterFaculty?null:this.filterFaculty.faculty_id},angular.bind(this,function(i,t,e,n){this.trainingTypes=i.properties.type}))},this.retrieveTrainings=function(){this.isLoadingTrainingList=!0,i.callChamiloAjax("Ehb\\Application\\Ects\\Ajax","FilterTrainings",{year:null==this.filterAcademicYear?null:this.filterAcademicYear,faculty:null==this.filterFaculty?null:this.filterFaculty.faculty_id,type:null==this.filterTrainingType?null:this.filterTrainingType.type_id,text:this.filterText},angular.bind(this,function(i,t,e,n){this.trainingsByType=i.properties.type,this.isLoadingTrainingList=!1}))},this.changeTraining=function(i){this.training=i},this.retrieveTraining=function(i){this.retrieveTrainingById(i.id)},this.retrieveTrainingById=function(t){this.isLoadingTraining=!0,i.callChamiloAjax("Ehb\\Application\\Ects\\Ajax","Training",{training:t},angular.bind(this,function(i,t,e,n){this.changeTraining(i.properties),this.isLoadingTraining=!1}))},this.changeAcademicYear=function(i){this.filterAcademicYear=i,this.filterFaculty=null,this.filterTrainingType=null,this.retrieveFaculties(),this.retrieveTrainingTypes(),this.retrieveTrainings()},this.setFaculty=function(i){this.filterFaculty=i,this.filterTrainingType=null},this.changeFaculty=function(i){this.setFaculty(i),this.retrieveTrainingTypes(),this.retrieveTrainings()},this.setTrainingType=function(i){this.filterTrainingType=i},this.changeTrainingType=function(i){this.setTrainingType(i),this.retrieveTrainings()},this.setFilterText=function(i){this.filterText=i},this.changeFilterText=function(i){this.setFilterText(i),this.retrieveTrainings()}}]),t.service("coursesService",["chamiloUtilities",function(i){this.subTrajectory=null,this.course=null,this.isLoadingSubTrajectory=!1,this.isLoadingCourse=!1,this.isLoadingCourseDetails=!1,this.changeSubTrajectory=function(i){this.subTrajectory=i},this.retrieveSubTrajectory=function(i){this.retrieveSubTrajectoryById(i.id)},this.retrieveSubTrajectoryById=function(t){this.isLoadingSubTrajectory=!0,i.callChamiloAjax("Ehb\\Application\\Ects\\Ajax","Trajectory",{sub_trajectory:t},angular.bind(this,function(i,t,e,n){this.changeSubTrajectory(i.properties),this.isLoadingSubTrajectory=!1}))},this.retrieveCourseById=function(t){this.isLoadingCourse=!0,i.callChamiloAjax("Ehb\\Application\\Ects\\Ajax","Course",{course:t},angular.bind(this,function(i,e,n,r){this.course=i.properties,this.isLoadingCourse=!1,this.retrieveCourseDetailsById(t)}))},this.retrieveCourseDetailsById=function(t){this.isLoadingCourseDetails=!0,i.callChamiloAjax("Ehb\\Application\\Ects\\Ajax","CourseDetails",{course:t},angular.bind(this,function(i,t,e,n){this.courseDetails=i.properties,this.isLoadingCourseDetails=!1}))}}])}();